{"version":3,"sources":["index.ts"],"names":[],"mappings":"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","file":"border.42f86dbc.js","sourceRoot":"..","sourcesContent":["var tileSize = 4;\nvar pixelRatio = 4;\n\nlet canvas = <HTMLCanvasElement>document.getElementById(\"editor\");\nlet renderCanvas = <HTMLCanvasElement>document.getElementById(\"render\");\ncanvas.width = tileSize * pixelRatio * 3;\ncanvas.height = tileSize * pixelRatio * 3;\nrenderCanvas.width = tileSize * pixelRatio * 3;\nrenderCanvas.height = tileSize * pixelRatio * 3;\nvar ctx = canvas.getContext(\"2d\");\nvar renderCtx = renderCanvas.getContext(\"2d\");\nvar isDown = false;\n\nfunction newCell() {\n  let rows = new Array(tileSize).fill(0);\n  return rows.map((v, i) => new Array(tileSize).fill(0));\n}\nfunction newGrid() {\n  let rows = new Array(3).fill(0);\n  return rows.map((v, i) => {\n    let col = new Array(3).fill(0);\n    return col.map((v, i) => newCell());\n  });\n}\n\nlet map = newGrid();\nconsole.log(map);\n\nfunction randomInt(amin, amax?: number) {\n  var min = amin;\n  var max = amax;\n  if (arguments.length == 1) {\n    min = 0;\n    max = amin;\n  }\n  min = Math.ceil(min);\n  max = Math.floor(max);\n  return Math.floor(Math.random() * (max - min)) + min;\n}\n\nfunction randomLoc() {\n  return [randomInt(3), randomInt(3), randomInt(tileSize), randomInt(tileSize)];\n}\nfunction setLoc(loc, v) {\n  let address = loc.slice(0, -1);\n  let lastPos = loc[loc.length - 1];\n  console.log(v);\n  address.reduce((acc, i) => acc[i], map)[lastPos] = v;\n}\nfunction getLoc(loc) {\n  return loc.reduce((acc, i) => acc[i], map);\n}\nsetLoc([0, 0, 0, 0]);\nsetLoc([2, 2, 0, 0]);\nsetLoc(randomLoc());\nsetLoc(randomLoc());\nsetLoc(randomLoc());\nsetLoc(randomLoc());\nsetLoc(randomLoc());\nsetLoc(randomLoc());\nsetLoc(randomLoc());\nsetLoc(randomLoc());\nsetLoc(randomLoc());\nsetLoc(randomLoc());\nsetLoc(randomLoc());\n\nfunction renderMap(map) {\n\n    renderCtx.fill()\n  for (let sx = 0; sx < 3; sx++) {\n    for (let sy = 0; sy < 3; sy++) {\n      for (let cx = 0; cx < tileSize; cx++) {\n        for (let cy = 0; cy < tileSize; cy++) {\n          let v = getLoc([sx, sy, cx, cy]);\n          ctx.fillStyle = v == 1 ? \"#000\" : \"#fff0\";\n          renderCtx.fillStyle = v == 1 ? \"#000\" : \"#fff0\";\n          let gridX = (sx * tileSize + cx) * pixelRatio;\n          let gridY = (sy * tileSize + cy) * pixelRatio;\n          ctx.fillRect(gridX + 1, gridY + 1, pixelRatio - 1, pixelRatio - 1);\n          renderCtx.fillRect(gridX, gridY, pixelRatio, pixelRatio);\n        }\n      }\n    }\n  }\n}\nfor (let index = 0; index < 3; index++) {\n  ctx.strokeStyle = \"#999\";\n  ctx.lineWidth = 0.5;\n  let x = (index * canvas.width) / 3;\n  ctx.beginPath();\n  ctx.moveTo(x, 0);\n  ctx.lineTo(x, canvas.height);\n  ctx.stroke();\n  ctx.beginPath();\n  ctx.moveTo(0, x);\n  ctx.lineTo(canvas.height, x);\n  ctx.stroke();\n}\n\nfor (let index = 0; index < 3 * tileSize; index++) {\n  ctx.strokeStyle = \"#ccc\";\n    let x = ((index * canvas.width) / (3 * tileSize);\n    ctx.beginPath();\n    ctx.moveTo(x, 0);\n    ctx.lineTo(x, canvas.height);\n    ctx.stroke();\n    ctx.beginPath();\n    ctx.moveTo(0, x);\n    ctx.lineTo(canvas.height, x);\n    ctx.stroke();\n}\nrenderMap(map);\nsetBorder();\nfunction setBorder() {\n  let dataURI = renderCanvas.toDataURL();\n  let target = <HTMLElement>document.getElementById(\"target\");\n\n  target.style.borderImage = `url(\"${dataURI}\")`;\n  target.style.borderImageSlice = `${tileSize * pixelRatio} `;\n  target.style.borderImageWidth = `${tileSize * pixelRatio}px`;\n  target.style.borderImageRepeat = \"repeat\";\n  target.style.borderWidth = `${tileSize * pixelRatio}px`;\n  target.style.borderStyle = \"solid\";\n}\nlet draw = (e, isClick) => {\n  if (!isDown) {\n    return;\n  }\n  let { left, top, width, height } = canvas.getBoundingClientRect();\n  let x = e.clientX - left;\n  let y = e.clientY - top;\n\n  let canvasX = (x / width) * canvas.width;\n  let canvasY = (y / height) * canvas.height;\n  let gridX = Math.floor(canvasX / pixelRatio);\n  let gridY = Math.floor(canvasY / pixelRatio);\n\n  let sx = Math.floor(gridX / tileSize);\n  let sy = Math.floor(gridY / tileSize);\n  let cx = gridX % tileSize;\n  let cy = gridY % tileSize;\n  let loc =[sx, sy, cx, cy];\n  let v = getLoc(loc)||0; \n  console.log(v);\n  if(!isClick){\n    v = 0;\n  }\n  setLoc(loc, 1-v);\n  //   ctx.fillStyle = \"#000\";\n  //   ctx.fillRect(gridX, gridY, pixelRatio, pixelRatio);\n  renderMap(map);\n  setBorder();\n};\n\ncanvas.addEventListener(\"mousedown\", e => {\n  isDown = true;\n  draw(e, true);\n});\ncanvas.addEventListener(\"mousemove\", draw);\ncanvas.addEventListener(\"mouseup\", () => {\n  isDown = false;\n});\ncanvas.addEventListener(\"mouseleave\", () => {\n  isDown = false;\n});\n"]}